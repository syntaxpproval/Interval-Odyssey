#include "tileset.h"

// Individual tile arrays for metatiles
const UINT8 floor_tiles[4] = {TILE_FLOOR, TILE_FLOOR, TILE_FLOOR, TILE_FLOOR};
const UINT8 wall_tiles[4] = {TILE_WALL_TL, TILE_WALL_TL, TILE_WALL_TL, TILE_WALL_TL};
const UINT8 key_tiles[4] = {TILE_KEY, TILE_KEY, TILE_KEY, TILE_KEY};
const UINT8 gate_tiles[4] = {TILE_GATE, TILE_GATE, TILE_GATE, TILE_GATE};
const UINT8 player_tiles[4] = {TILE_WALL_TL, TILE_WALL_TL, TILE_WALL_TL, TILE_WALL_TL};


const MetaTile metatiles[] = {
    {.tiles = {TILE_FLOOR, TILE_FLOOR, TILE_FLOOR, TILE_FLOOR}, .walkable = 1, .destructible = 0},  // MT_FLOOR
    {.tiles = {TILE_WALL_TL, TILE_WALL_TL, TILE_WALL_TL, TILE_WALL_TL}, .walkable = 0, .destructible = 0},  // MT_WALL
    {.tiles = {TILE_KEY, TILE_KEY, TILE_KEY, TILE_KEY}, .walkable = 1, .destructible = 0},  // MT_KEY
    {.tiles = {TILE_GATE, TILE_GATE, TILE_GATE, TILE_GATE}, .walkable = 0, .destructible = 0},  // MT_GATE
    {.tiles = {TILE_WALL_TL, TILE_WALL_TL, TILE_WALL_TL, TILE_WALL_TL}, .walkable = 1, .destructible = 0},   // MT_PLAYER
    {.tiles = {GAME_TILE_OFFSET + 4, GAME_TILE_OFFSET + 4, GAME_TILE_OFFSET + 4, GAME_TILE_OFFSET + 4}, .walkable = 0, .destructible = 1},  // MT_ENEMY_X
    {.tiles = {GAME_TILE_OFFSET + 5, GAME_TILE_OFFSET + 5, GAME_TILE_OFFSET + 5, GAME_TILE_OFFSET + 5}, .walkable = 0, .destructible = 1},  // MT_ENEMY_Y
    {.tiles = {GAME_TILE_OFFSET + 6, GAME_TILE_OFFSET + 6, GAME_TILE_OFFSET + 6, GAME_TILE_OFFSET + 6}, .walkable = 0, .destructible = 1},   // MT_ENEMY_Z
    {.tiles = {TILE_OBSTACLE, TILE_OBSTACLE, TILE_OBSTACLE, TILE_OBSTACLE}, .walkable = 0, .destructible = 0}  // MT_OBSTACLE
};

// Font tileset (your existing converted font data goes here)
const UINT8 TILESET[] = {
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x00, 0x00, 0x10, 0x10, 0x00, 0x00,
    0x28, 0x28, 0x28, 0x28, 0x28, 0x28, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x28, 0x28, 0x28, 0x28, 0x7C, 0x7C, 0x28, 0x28, 0x28, 0x28, 0x7C, 0x7C, 0x28, 0x28, 0x28, 0x28,
    0x38, 0x38, 0x54, 0x54, 0x50, 0x50, 0x38, 0x38, 0x14, 0x14, 0x54, 0x54, 0x38, 0x38, 0x00, 0x00,
    0x20, 0x20, 0x52, 0x52, 0x24, 0x24, 0x08, 0x08, 0x10, 0x10, 0x24, 0x24, 0x4A, 0x4A, 0x04, 0x04,
    0x10, 0x10, 0x28, 0x28, 0x10, 0x10, 0x34, 0x34, 0x48, 0x48, 0x48, 0x48, 0x34, 0x34, 0x00, 0x00,
    0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x02, 0x02, 0x04, 0x04, 0x04, 0x04, 0x08, 0x08, 0x08, 0x08, 0x04, 0x04, 0x04, 0x04, 0x02, 0x02,
    0x40, 0x40, 0x20, 0x20, 0x20, 0x20, 0x10, 0x10, 0x10, 0x10, 0x20, 0x20, 0x20, 0x20, 0x40, 0x40,
    0x00, 0x00, 0x28, 0x28, 0x10, 0x10, 0x7C, 0x7C, 0x10, 0x10, 0x28, 0x28, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x10, 0x10, 0x10, 0x10, 0x7C, 0x7C, 0x10, 0x10, 0x10, 0x10, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x30, 0x30, 0x30, 0x30, 0x10, 0x10, 0x20, 0x20,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7C, 0x7C, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x30, 0x30, 0x30, 0x30, 0x00, 0x00, 0x00, 0x00,
    0x04, 0x04, 0x04, 0x04, 0x08, 0x08, 0x08, 0x08, 0x10, 0x10, 0x10, 0x10, 0x20, 0x20, 0x20, 0x20,
    0x38, 0x38, 0x44, 0x44, 0x54, 0x54, 0x54, 0x54, 0x54, 0x54, 0x44, 0x44, 0x38, 0x38, 0x00, 0x00,
    0x10, 0x10, 0x30, 0x30, 0x50, 0x50, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x7C, 0x7C, 0x00, 0x00,
    0x38, 0x38, 0x44, 0x44, 0x08, 0x08, 0x10, 0x10, 0x20, 0x20, 0x40, 0x40, 0x7C, 0x7C, 0x00, 0x00,
    0x38, 0x38, 0x44, 0x44, 0x18, 0x18, 0x04, 0x04, 0x04, 0x04, 0x44, 0x44, 0x38, 0x38, 0x00, 0x00,
    0x04, 0x04, 0x0C, 0x0C, 0x14, 0x14, 0x24, 0x24, 0x44, 0x44, 0x7E, 0x7E, 0x04, 0x04, 0x00, 0x00,
    0x7C, 0x7C, 0x40, 0x40, 0x78, 0x78, 0x04, 0x04, 0x04, 0x04, 0x44, 0x44, 0x38, 0x38, 0x00, 0x00,
    0x18, 0x18, 0x20, 0x20, 0x40, 0x40, 0x78, 0x78, 0x44, 0x44, 0x44, 0x44, 0x38, 0x38, 0x00, 0x00,
    0x7C, 0x7C, 0x08, 0x08, 0x08, 0x08, 0x10, 0x10, 0x10, 0x10, 0x20, 0x20, 0x20, 0x20, 0x00, 0x00,
    0x38, 0x38, 0x44, 0x44, 0x44, 0x44, 0x38, 0x38, 0x44, 0x44, 0x44, 0x44, 0x38, 0x38, 0x00, 0x00,
    0x38, 0x38, 0x44, 0x44, 0x44, 0x44, 0x3C, 0x3C, 0x04, 0x04, 0x08, 0x08, 0x30, 0x30, 0x00, 0x00,
    0x00, 0x00, 0x30, 0x30, 0x30, 0x30, 0x00, 0x00, 0x30, 0x30, 0x30, 0x30, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x30, 0x30, 0x30, 0x30, 0x00, 0x00, 0x30, 0x30, 0x30, 0x30, 0x10, 0x10, 0x20, 0x20,
    0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x10, 0x10, 0x08, 0x08, 0x04, 0x04, 0x02, 0x02, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x7C, 0x7C, 0x00, 0x00, 0x7C, 0x7C, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x40, 0x40, 0x20, 0x20, 0x10, 0x10, 0x08, 0x08, 0x10, 0x10, 0x20, 0x20, 0x40, 0x40, 0x00, 0x00,
    0x38, 0x38, 0x44, 0x44, 0x08, 0x08, 0x10, 0x10, 0x10, 0x10, 0x00, 0x00, 0x10, 0x10, 0x00, 0x00,
    0xFE, 0xFE, 0xEE, 0xEE, 0x82, 0x82, 0xC6, 0xC6, 0xC6, 0xC6, 0xBA, 0xBA, 0xFE, 0xFE, 0x00, 0x00,
    0x38, 0x38, 0x44, 0x44, 0x44, 0x44, 0x7C, 0x7C, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x00, 0x00,
    0x78, 0x78, 0x44, 0x44, 0x78, 0x78, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x78, 0x78, 0x00, 0x00,
    0x38, 0x38, 0x44, 0x44, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x44, 0x44, 0x38, 0x38, 0x00, 0x00,
    0x70, 0x70, 0x48, 0x48, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x48, 0x48, 0x70, 0x70, 0x00, 0x00,
    0x7C, 0x7C, 0x40, 0x40, 0x78, 0x78, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x7C, 0x7C, 0x00, 0x00,
    0x7C, 0x7C, 0x40, 0x40, 0x78, 0x78, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x00, 0x00,
    0x38, 0x38, 0x44, 0x44, 0x40, 0x40, 0x4C, 0x4C, 0x44, 0x44, 0x44, 0x44, 0x38, 0x38, 0x00, 0x00,
    0x44, 0x44, 0x44, 0x44, 0x7C, 0x7C, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x00, 0x00,
    0x70, 0x70, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x70, 0x70, 0x00, 0x00,
    0x1C, 0x1C, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x44, 0x44, 0x44, 0x44, 0x38, 0x38, 0x00, 0x00,
    0x44, 0x44, 0x48, 0x48, 0x70, 0x70, 0x48, 0x48, 0x48, 0x48, 0x44, 0x44, 0x44, 0x44, 0x00, 0x00,
    0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x7C, 0x7C, 0x00, 0x00,
    0x44, 0x44, 0x6C, 0x6C, 0x54, 0x54, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x00, 0x00,
    0x44, 0x44, 0x64, 0x64, 0x54, 0x54, 0x54, 0x54, 0x4C, 0x4C, 0x4C, 0x4C, 0x44, 0x44, 0x00, 0x00,
    0x38, 0x38, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x38, 0x38, 0x00, 0x00,
    0x78, 0x78, 0x44, 0x44, 0x44, 0x44, 0x78, 0x78, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x00, 0x00,
    0x38, 0x38, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x48, 0x48, 0x34, 0x34, 0x04, 0x04,
    0x78, 0x78, 0x44, 0x44, 0x78, 0x78, 0x48, 0x48, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x00, 0x00,
    0x38, 0x38, 0x40, 0x40, 0x38, 0x38, 0x04, 0x04, 0x04, 0x04, 0x44, 0x44, 0x38, 0x38, 0x00, 0x00,
    0x7C, 0x7C, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x00, 0x00,
    0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x38, 0x38, 0x00, 0x00,
    0x44, 0x44, 0x44, 0x44, 0x28, 0x28, 0x28, 0x28, 0x28, 0x28, 0x10, 0x10, 0x10, 0x10, 0x00, 0x00,
    0x44, 0x44, 0x44, 0x44, 0x54, 0x54, 0x54, 0x54, 0x38, 0x38, 0x28, 0x28, 0x28, 0x28, 0x00, 0x00,
    0x44, 0x44, 0x28, 0x28, 0x10, 0x10, 0x10, 0x10, 0x28, 0x28, 0x44, 0x44, 0x44, 0x44, 0x00, 0x00,
    0x88, 0x88, 0x88, 0x88, 0x50, 0x50, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x00, 0x00,
    0x7C, 0x7C, 0x08, 0x08, 0x08, 0x08, 0x10, 0x10, 0x10, 0x10, 0x20, 0x20, 0x7C, 0x7C, 0x00, 0x00,
    0x38, 0x38, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x38, 0x38,
    0x20, 0x20, 0x20, 0x20, 0x10, 0x10, 0x10, 0x10, 0x08, 0x08, 0x08, 0x08, 0x04, 0x04, 0x04, 0x04,
    0x38, 0x38, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x38, 0x38,
    0x10, 0x10, 0x28, 0x28, 0x44, 0x44, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7C, 0x7C, 0x00, 0x00,
    0x6C, 0x6C, 0xFE, 0xFE, 0xFE, 0xFE, 0xFE, 0xFE, 0x7C, 0x7C, 0x38, 0x38, 0x10, 0x10, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x3C, 0x3C, 0x44, 0x44, 0x44, 0x44, 0x4C, 0x4C, 0x34, 0x34, 0x00, 0x00,
    0x40, 0x40, 0x40, 0x40, 0x78, 0x78, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x78, 0x78, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x38, 0x38, 0x44, 0x44, 0x40, 0x40, 0x44, 0x44, 0x38, 0x38, 0x00, 0x00,
    0x04, 0x04, 0x04, 0x04, 0x3C, 0x3C, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x3C, 0x3C, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x38, 0x38, 0x7C, 0x7C, 0x40, 0x40, 0x44, 0x44, 0x38, 0x38, 0x00, 0x00,
    0x1C, 0x1C, 0x20, 0x20, 0x20, 0x20, 0x78, 0x78, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x3C, 0x3C, 0x44, 0x44, 0x44, 0x44, 0x3C, 0x3C, 0x04, 0x04, 0x38, 0x38,
    0x40, 0x40, 0x40, 0x40, 0x78, 0x78, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x00, 0x00,
    0x20, 0x20, 0x00, 0x00, 0x60, 0x60, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x18, 0x18, 0x00, 0x00,
    0x10, 0x10, 0x00, 0x00, 0x30, 0x30, 0x10, 0x10, 0x10, 0x10, 0x50, 0x50, 0x20, 0x20, 0x00, 0x00,
    0x40, 0x40, 0x40, 0x40, 0x44, 0x44, 0x48, 0x48, 0x70, 0x70, 0x48, 0x48, 0x44, 0x44, 0x00, 0x00,
    0x60, 0x60, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x30, 0x30, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x68, 0x68, 0x54, 0x54, 0x54, 0x54, 0x54, 0x54, 0x54, 0x54, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x78, 0x78, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x38, 0x38, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x38, 0x38, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x78, 0x78, 0x44, 0x44, 0x44, 0x44, 0x78, 0x78, 0x40, 0x40, 0x40, 0x40,
    0x00, 0x00, 0x00, 0x00, 0x3C, 0x3C, 0x44, 0x44, 0x44, 0x44, 0x3C, 0x3C, 0x04, 0x04, 0x06, 0x06,
    0x00, 0x00, 0x00, 0x00, 0x78, 0x78, 0x44, 0x44, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x3C, 0x3C, 0x40, 0x40, 0x38, 0x38, 0x04, 0x04, 0x78, 0x78, 0x00, 0x00,
    0x00, 0x00, 0x20, 0x20, 0x78, 0x78, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x1C, 0x1C, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x3C, 0x3C, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x44, 0x44, 0x44, 0x44, 0x28, 0x28, 0x28, 0x28, 0x10, 0x10, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x44, 0x44, 0x44, 0x44, 0x54, 0x54, 0x54, 0x54, 0x28, 0x28, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x44, 0x44, 0x28, 0x28, 0x10, 0x10, 0x28, 0x28, 0x44, 0x44, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x3C, 0x3C, 0x04, 0x04, 0x38, 0x38,
    0x00, 0x00, 0x00, 0x00, 0x7C, 0x7C, 0x08, 0x08, 0x10, 0x10, 0x20, 0x20, 0x7C, 0x7C, 0x00, 0x00,
    0x0C, 0x0C, 0x10, 0x10, 0x10, 0x10, 0x60, 0x60, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x0C, 0x0C,
    0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x00, 0x00, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10,
    0x60, 0x60, 0x10, 0x10, 0x10, 0x10, 0x0C, 0x0C, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x60, 0x60,
    0x00, 0x00, 0x24, 0x24, 0x54, 0x54, 0x48, 0x48, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x38, 0x38, 0x26, 0x26, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x62, 0x62, 0x66, 0x66, 0x06, 0x06,
    0x6C, 0x6C, 0x92, 0x92, 0x82, 0x82, 0x82, 0x82, 0x82, 0x82, 0x44, 0x44, 0x28, 0x28, 0x10, 0x10,
    0x7C, 0x7C, 0x44, 0x44, 0x7C, 0x7C, 0x44, 0x44, 0x44, 0x44, 0xCC, 0xCC, 0xCC, 0xCC, 0x00, 0x00,
    0x38, 0x38, 0x6C, 0x6C, 0xC6, 0xC6, 0xAA, 0xAA, 0xEE, 0xEE, 0x6C, 0x6C, 0x38, 0x38, 0x00, 0x00,
    0x38, 0x38, 0x6C, 0x6C, 0xEE, 0xEE, 0xAA, 0xAA, 0xC6, 0xC6, 0x6C, 0x6C, 0x38, 0x38, 0x00, 0x00,
    0x38, 0x38, 0x6C, 0x6C, 0xDE, 0xDE, 0x82, 0x82, 0xDE, 0xDE, 0x6C, 0x6C, 0x38, 0x38, 0x00, 0x00,
    0x38, 0x38, 0x6C, 0x6C, 0xF6, 0xF6, 0x82, 0x82, 0xF6, 0xF6, 0x6C, 0x6C, 0x38, 0x38, 0x00, 0x00,
    0x38, 0x38, 0x6C, 0x6C, 0xD6, 0xD6, 0xC6, 0xC6, 0xD6, 0xD6, 0x7C, 0x7C, 0x38, 0x38, 0x00, 0x00,
    0x38, 0x38, 0x6C, 0x6C, 0xD6, 0xD6, 0xCE, 0xCE, 0xD6, 0xD6, 0x6C, 0x6C, 0x38, 0x38, 0x00, 0x00,
    0x00, 0x00, 0x7F, 0x7F, 0xC4, 0xC4, 0xDE, 0xDE, 0xE6, 0xE6, 0xC6, 0xC6, 0x7F, 0x7F, 0x00, 0x00,
    0x00, 0x00, 0xFF, 0xFF, 0x6C, 0x6C, 0xD5, 0xD5, 0xC4, 0xC4, 0xD5, 0xD5, 0xFF, 0xFF, 0x00, 0x00,
    0x00, 0x00, 0xFC, 0xFC, 0xC6, 0xC6, 0x6E, 0x6E, 0xEE, 0xEE, 0x6E, 0x6E, 0xFC, 0xFC, 0x00, 0x00,
    0x00, 0x00, 0x7F, 0x7F, 0xC4, 0xC4, 0xDC, 0xDC, 0xE5, 0xE5, 0xC4, 0xC4, 0x7F, 0x7F, 0x00, 0x00,
    0x00, 0x00, 0xFF, 0xFF, 0x58, 0x58, 0xD9, 0xD9, 0xDB, 0xDB, 0x48, 0x48, 0xFF, 0xFF, 0x00, 0x00,
    0x00, 0x00, 0xFE, 0xFE, 0x91, 0x91, 0xBB, 0xBB, 0xBB, 0xBB, 0x9B, 0x9B, 0xFE, 0xFE, 0x00, 0x00,
    0x30, 0x30, 0x48, 0x48, 0x48, 0x48, 0xFC, 0xFC, 0xFC, 0xFC, 0xFC, 0xFC, 0xFC, 0xFC, 0x00, 0x00,
    0x0C, 0x0C, 0x12, 0x12, 0x12, 0x12, 0xF8, 0xF8, 0xF8, 0xF8, 0xF8, 0xF8, 0xF8, 0xF8, 0x00, 0x00,
    0x18, 0x18, 0x14, 0x14, 0x18, 0x18, 0x14, 0x14, 0x10, 0x10, 0x30, 0x30, 0x30, 0x30, 0x00, 0x00,
    0x38, 0x38, 0x26, 0x26, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x62, 0x62, 0x66, 0x66, 0x06, 0x06,
    0x0E, 0x0E, 0x3E, 0x3E, 0x32, 0x32, 0x22, 0x22, 0x22, 0x22, 0x26, 0x26, 0x66, 0x66, 0x60, 0x60,
    0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x30, 0x30, 0x50, 0x50, 0x60, 0x60, 0x00, 0x00,
    0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x00, 0x00,
    0x28, 0x28, 0x28, 0x28, 0x28, 0x28, 0x28, 0x28, 0x28, 0x28, 0x28, 0x28, 0x28, 0x28, 0x00, 0x00,
    0x54, 0x54, 0x54, 0x54, 0x54, 0x54, 0x54, 0x54, 0x54, 0x54, 0x54, 0x54, 0x54, 0x54, 0x00, 0x00,
    0x54, 0x54, 0x54, 0x54, 0x54, 0x54, 0x54, 0x54, 0x54, 0x54, 0x48, 0x48, 0x48, 0x48, 0x00, 0x00,
    0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x28, 0x28, 0x28, 0x28, 0x10, 0x10, 0x10, 0x10, 0x00, 0x00,
    0x00, 0x00, 0x10, 0x10, 0x2C, 0x2C, 0x42, 0x42, 0x56, 0x42, 0x3C, 0x24, 0x18, 0x18, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x18, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x24, 0x24, 0x18, 0x18, 0x18, 0x18, 0x24, 0x24, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x42, 0x42, 0x24, 0x24, 0x00, 0x00, 0x00, 0x00, 0x24, 0x24, 0x42, 0x42, 0x00, 0x00,
    0x81, 0x81, 0x42, 0x42, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x42, 0x42, 0x81, 0x81,
};

const UINT8 room_templates[4][ROOM_HEIGHT][ROOM_WIDTH] = {
    // Pattern 1 - Corner obstacles
    {
        {1,1,1,1,1,1,1,1,1,1},
        {1,0,0,0,0,0,0,0,0,1},
        {1,0,8,0,0,0,0,8,0,1},
        {1,0,0,0,0,0,0,0,0,1},
        {1,0,0,0,0,0,0,0,0,1},
        {1,0,0,0,0,0,0,0,0,1},
        {1,0,8,0,0,0,0,8,0,1},
        {1,1,1,1,1,1,1,1,1,1}
    },
    
    // Pattern 2 - Central path with side obstacles
    {
        {1,1,1,1,1,1,1,1,1,1},
        {1,0,0,0,0,0,0,0,0,1},
        {1,8,0,0,0,0,0,0,8,1},
        {1,0,0,0,0,0,0,0,0,1},
        {1,0,0,0,0,0,0,0,0,1},
        {1,8,0,0,0,0,0,0,8,1},
        {1,0,0,0,0,0,0,0,0,1},
        {1,1,1,1,1,1,1,1,1,1}
    },
    
    // Pattern 3 - Diagonal obstacles
    {
        {1,1,1,1,1,1,1,1,1,1},
        {1,0,0,0,0,0,0,0,0,1},
        {1,0,8,0,0,0,0,0,0,1},
        {1,0,0,8,0,0,0,0,0,1},
        {1,0,0,0,0,8,0,0,0,1},
        {1,0,0,0,0,0,8,0,0,1},
        {1,0,0,0,0,0,0,0,0,1},
        {1,1,1,1,1,1,1,1,1,1}
    },
    
    // Pattern 4 - Cross pattern
    {
        {1,1,1,1,1,1,1,1,1,1},
        {1,0,0,0,8,8,0,0,0,1},
        {1,0,0,0,8,8,0,0,0,1},
        {1,0,0,0,0,0,0,0,0,1},
        {1,0,0,0,0,0,0,0,0,1},
        {1,0,0,0,8,8,0,0,0,1},
        {1,8,8,8,8,8,8,8,8,1},
        {1,1,1,1,1,1,1,1,1,1}
    }
};

// Character to tile mapping
const unsigned char char_to_tile[] = {
    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  // 0x00-0x0F
    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  // 0x10-0x1F
    0,  1,  2,  3,  4,  5,  6,  7,  8,  9,  10, 11, 12, 13, 14, 15, // 0x20-0x2F
    16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, // 0x30-0x3F
    32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, // 0x40-0x4F
    48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, // 0x50-0x5F
    64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, // 0x60-0x6F
    80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95  // 0x70-0x7F
};

const unsigned char game_tiles[] = {
    // TILE 0: Floor (completely blank)
    0x00, 0x00,
    0x00, 0x00,
    0x00, 0x00,
    0x00, 0x00,
    0x00, 0x00,
    0x00, 0x00,
    0x00, 0x00,
    0x00, 0x00,

    // TILE 1: Wall (solid black)
    0xFF, 0xFF,
    0xFF, 0xFF,
    0xFF, 0xFF,
    0xFF, 0xFF,
    0xFF, 0xFF,
    0xFF, 0xFF,
    0xFF, 0xFF,
    0xFF, 0xFF,

    // TILE 2: Key
    0x00, 0x00,
    0x18, 0x00,
    0x24, 0x00,
    0x24, 0x00,
    0x18, 0x00,
    0x08, 0x00,
    0x1C, 0x00,
    0x08, 0x00,

    // TILE 3: Gate
    0xFF, 0xFF,
    0x81, 0x81,
    0xBD, 0xBD,
    0xBD, 0xBD,
    0xBD, 0xBD,
    0xBD, 0xBD,
    0x81, 0x81,
    0xFF, 0xFF,
	
// TILE 4: Enemy X
0x00, 0x00,
0x00, 0x42,
0x00, 0x24,
0x00, 0x18,
0x00, 0x18,
0x00, 0x24,
0x00, 0x42,
0x00, 0x00,

// TILE 5: Enemy Y
0x00, 0x00,
0x00, 0x24,
0x00, 0x24,
0x00, 0x18,
0x00, 0x18,
0x00, 0x3C,
0x00, 0x24,
0x00, 0x00,

// TILE 6: Enemy Z
0x00, 0x00,
0x00, 0x7E,
0x00, 0x02,
0x00, 0x1C,
0x00, 0x30,
0x00, 0x40,
0x00, 0x7E,
0x00, 0x00,

    0xFF, 0xFF,
    0xFF, 0x81,
    0xFF, 0xBD,
    0xFF, 0xA5,
    0xFF, 0xA5,
    0xFF, 0xBD,
    0xFF, 0x81,
    0xFF, 0xFF
};

#include "tileset.h"

const MetaTile16 metatiles16[] = {
    // WALL1 (using music note tile 114 for all four positions)
    {114, 114,    // Top row (left, right)
     114, 114,    // Bottom row (left, right)
     0, 0},       // walkable and destructible flags
    
    // FLOOR
    {138, 139, 158, 159, 1, 0},
    
    // POWERUP
    {140, 141, 160, 161, 1, 1},
    
    // ENEMY_X
    {142, 143, 162, 163, 0, 1},
    
    // ENEMY_Y
    {144, 145, 164, 165, 0, 1},
    
    // ENEMY_Z
    {146, 147, 166, 167, 0, 1},
    
    // GATE_CLOSED
    {148, 149, 168, 169, 0, 0},
    
    // GATE_OPEN
    {150, 151, 170, 171, 1, 0},
    
    // KEY
    {152, 153, 172, 173, 1, 1},
    
    // HEART
    {154, 155, 174, 175, 1, 1},
    
    // PLAYER ANIMATIONS
    // Front animations
    {176, 177, 196, 197, 1, 0},  // Left foot
    {178, 179, 198, 199, 1, 0},  // Standing
    {180, 181, 200, 201, 1, 0},  // Right foot
    
    // Back animations
    {182, 183, 202, 203, 1, 0},  // Left foot
    {184, 185, 204, 205, 1, 0},  // Standing
    {186, 187, 206, 207, 1, 0},  // Right foot
    
    // Side animations
    {188, 189, 208, 209, 1, 0},  // Left walking
    {190, 191, 210, 211, 1, 0},  // Left standing
    {192, 193, 212, 213, 1, 0},  // Right standing
    {194, 195, 214, 215, 1, 0},  // Right walking
	
    // HP Numbers and special tiles (20-29)
    {216, 217, 236, 237, 1, 0},  // HP 1
    {218, 219, 238, 239, 1, 0},  // HP 2
    {220, 221, 240, 241, 1, 0},  // HP 3
    {222, 223, 242, 243, 1, 0},  // HP 4
    {224, 225, 244, 245, 1, 0},  // HP 5
    {226, 227, 246, 247, 1, 0},  // HP 6
    {228, 229, 248, 249, 1, 0},  // HP 7
    {230, 231, 250, 251, 1, 0},  // HP Unknown (?)
    {232, 233, 252, 253, 1, 0},  // PIT
    {234, 235, 254, 255, 1, 0},   // RESERVED
	
    // OBSTACLE (using original wall tile for obstacles)
    {TILE_WALL_TL, TILE_WALL_TL,
     TILE_WALL_TL, TILE_WALL_TL,
     0, 0}  // Not walkable

};

UINT8 get_player_tile(PlayerAnimation* anim) {
    switch(anim->direction) {
        case 0: // Front
            if(!anim->frame) return MTL_PLAYER_FRONT_S;
            return (anim->frame_count < 8) ? MTL_PLAYER_FRONT_L : MTL_PLAYER_FRONT_R;
            
        case 1: // Back
            if(!anim->frame) return MTL_PLAYER_BACK_S;
            return (anim->frame_count < 8) ? MTL_PLAYER_BACK_L : MTL_PLAYER_BACK_R;
            
        case 2: // Left
            if(!anim->frame) return MTL_PLAYER_LEFT_S;
            return MTL_PLAYER_LEFT_W;
            
        case 3: // Right
            if(!anim->frame) return MTL_PLAYER_RIGHT_S;
            return MTL_PLAYER_RIGHT_W;
    }
    return MTL_PLAYER_FRONT_S;  // Default
}

// Animation update function
void update_player_animation(PlayerAnimation* anim, UINT8 moving) {
    if(moving) {
        anim->frame = 1;
        anim->frame_count = (anim->frame_count + 1) & 15;  // 16 frame animation cycle
    } else {
        anim->frame = 0;
        anim->frame_count = 0;
    }
}

void set_metatile16(UINT8 x, UINT8 y, UINT8 metatile_id) {
    const MetaTile16* mt = &metatiles16[metatile_id];
    UINT8 base_x = x * 2;
    UINT8 base_y = y * 2;
    
    set_bkg_tile_xy(base_x, base_y, mt->top_left);
    set_bkg_tile_xy(base_x + 1, base_y, mt->top_right);
    set_bkg_tile_xy(base_x, base_y + 1, mt->bottom_left);
    set_bkg_tile_xy(base_x + 1, base_y + 1, mt->bottom_right);
}

void set_metatile(UINT8 x, UINT8 y, UINT8 metatile_id) {
    const MetaTile* mt = &metatiles[metatile_id];
    UINT8 base_x = x * 2;
    UINT8 base_y = y * 2;
    
    set_bkg_tile_xy(base_x, base_y, mt->tiles[0]);
    set_bkg_tile_xy(base_x + 1, base_y, mt->tiles[1]); 
    set_bkg_tile_xy(base_x, base_y + 1, mt->tiles[2]);
    set_bkg_tile_xy(base_x + 1, base_y + 1, mt->tiles[3]);
}

// Keep existing helper functions
void set_large_tile(UINT8 x, UINT8 y, UINT8 tile) {
   set_bkg_tile_xy(x, y, tile);
}

void draw_text(UINT8 x, UINT8 y, const char *text) {
   while(*text) {
       UINT8 c = (UINT8)*text;
       if(c >= 32) {
           set_bkg_tile_xy(x, y, char_to_tile[c]);
           x++;
       }
       text++;
   }
}
   
void draw_special_tile(UINT8 x, UINT8 y, UINT8 tile) {
   set_bkg_tile_xy(x, y, tile);
}